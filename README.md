# Task Tracker API

Task Tracker API — это RESTful API для управления задачами сотрудников, разработанное на Django. С помощью этого API можно управлять сотрудниками и их задачами, а также получать информацию о загруженности сотрудников и важных задачах, которые требуют внимания. Проект включает поддержку аутентификации с использованием JWT, а также предоставляет документацию API через Swagger и ReDoc.

## Стек технологий

- Python 3.12
- Django 5.1
- Django REST Framework
- PostgreSQL
- Docker
- Swagger (drf_yasg)
- JWT (rest_framework_simplejwt)

## Функциональность

### Основные функции

#### CRUD операции для сотрудников

- **Создание, чтение, обновление и удаление записей о сотрудниках.**
- **Поля:**
  - ФИО
  - Должность
  - Отдел
  - Дата приема на работу

#### CRUD операции для задач

- **Создание, чтение, обновление и удаление записей о задачах.**
- **Поля:**
  - Наименование
  - Ссылка на родительскую задачу (если есть зависимость)
  - Исполнитель
  - Срок
  - Статус


### Специальные эндпоинты

#### Занятые сотрудники

- **Возвращает список сотрудников и их задачи, отсортированный по количеству активных задач.**

#### Важные задачи

- **Возвращает задачи, которые не взяты в работу, но от которых зависят другие задачи, взятые в работу.**
- **Находит сотрудников, которые могут взять эти задачи (наименее загруженный или выполняющий родительскую задачу).**
- **Формат ответа:**
  - `{Важная задача, Срок, [ФИО сотрудника]}`

## Запуск проекта

### Локальный запуск

1. Клонируйте репозиторий:

    ```bash
    git clone https://github.com/Crazilina/task_tracker.git
    cd task_tracker
    ```

2. Создайте и активируйте виртуальное окружение:

    ```bash
    python -m venv env
    source env/bin/activate
    ```

3. Установите зависимости:

    ```bash
    pip install -r requirements.txt
    ```

4. #### Настройка переменных окружения

Перед запуском проекта необходимо настроить переменные окружения. Для этого:

1. Скопируйте шаблон файла `.env.sample` в файл `.env`:

    ```bash
    cp .env.sample .env
    ```

2. Откройте файл `.env` в любом текстовом редакторе и заполните его своими значениями:


    - `DJANGO_SECRET_KEY`: Секретный ключ для вашего проекта Django. Вы можете использовать свой секретный ключ или сгенерировать его с помощью команды:

        ```python
        python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
        ```

    - `POSTGRES_DB`: Имя базы данных PostgreSQL, которую будет использовать ваше приложение.
    - `POSTGRES_USER`: Имя пользователя базы данных PostgreSQL.
    - `POSTGRES_PASSWORD`: Пароль пользователя базы данных PostgreSQL.
    - `POSTGRES_HOST`: Хост базы данных.
    - `POSTGRES_PORT`: Порт для подключения к базе данных PostgreSQL (по умолчанию `5432`).

    - `SUPERUSER_EMAIL`: Email суперпользователя, который будет создан автоматически.
    - `SUPERUSER_PASSWORD`: Пароль для суперпользователя.

    - `DEBUG`: Установите `True` для режима отладки или `False` для продакшена.

3. Сохраните файл `.env` после заполнения.

После этого вы можете продолжить установку и запуск проекта, следуя остальным инструкциям.


5. **Примените миграции и создайте суперпользователя**:

   a) Примените миграции:
    
        ```bash
        python manage.py makemigrations
        python manage.py migrate
        ```

    b) Автоматически создайте суперпользователя с использованием команды `csu`:

        ```bash
        python manage.py csu
        ```
_Команда `csu` создаёт суперпользователя с предопределёнными значениями из переменных окружения._

### Важная информация

Для полноценной работы с API необходимо создать суперпользователя. Суперпользователь имеет доступ ко всем административным функциям, а также может управлять доступом к защищённым эндпойнтам.

**Без создания суперпользователя доступ к большинству эндпойнтов будет закрыт, и вы не сможете полноценно взаимодействовать с приложением.**


6. Запустите сервер разработки:

    ```bash
    python manage.py runserver
    ```
7. **Доступ к админ-панели**:

    Откройте в браузере: `http://127.0.0.1:8000/admin/` и войдите с использованием учетных данных суперпользователя.

---


### Запуск проекта в Docker

1. Клонируйте репозиторий:

    ```bash
    git clone https://github.com/Crazilina/task_tracker.git
    cd task_tracker
    ```

2. #### Настройка переменных окружения

Перед запуском проекта необходимо настроить переменные окружения. Для этого:

1) Скопируйте шаблон файла `.env.sample` в файл `.env`:

    ```bash
    cp .env.sample .env
    ```

2) Откройте файл `.env` в любом текстовом редакторе и заполните его своими значениями:


    - `DJANGO_SECRET_KEY`: Секретный ключ для вашего проекта Django. Вы можете использовать свой секретный ключ или сгенерировать его с помощью команды:

        ```python
        python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
        ```

    - `POSTGRES_DB`: Имя базы данных PostgreSQL, которую будет использовать ваше приложение.
    - `POSTGRES_USER`: Имя пользователя базы данных PostgreSQL.
    - `POSTGRES_PASSWORD`: Пароль пользователя базы данных PostgreSQL.
    - `POSTGRES_HOST`: Хост базы данных. Если вы используете Docker, установите значение `db`.
    - `POSTGRES_PORT`: Порт для подключения к базе данных PostgreSQL (по умолчанию `5432`).

    - `SUPERUSER_EMAIL`: Email суперпользователя, который будет создан автоматически.
    - `SUPERUSER_PASSWORD`: Пароль для суперпользователя.

    - `DEBUG`: Установите `True` для режима отладки или `False` для продакшена.


3) Сохраните файл `.env` после заполнения.

После этого вы можете продолжить установку и запуск проекта, следуя остальным инструкциям.


3. Соберите и запустите контейнеры:

    ```bash
    docker-compose up -d --build
    ```

4. Примените миграции и создайте суперпользователя:

    Для этого выполните команду в контейнере:

    ```bash
    docker-compose run --rm app python manage.py migrate
    docker-compose run --rm app python manage.py csu
    ```
Команда `csu` создаёт суперпользователя с предопределёнными значениями из переменных окружения.

### Важная информация

Для полноценной работы с API необходимо создать суперпользователя. Суперпользователь имеет доступ ко всем административным функциям, а также может управлять доступом к защищённым эндпойнтам.

**Без создания суперпользователя доступ к большинству эндпойнтов будет закрыт, и вы не сможете полноценно взаимодействовать с приложением.**

 
5.Откройте браузер и перейдите по адресу `http://localhost:8000/swagger/`, чтобы просмотреть документацию API.


6. **Доступ к админ-панели**:

    Откройте в браузере: `http://127.0.0.1:8000/admin/` и войдите с использованием учетных данных суперпользователя.


7. **Остановка контейнеров**:

    Для остановки контейнеров и удаления их используйте команду:
```bash
    docker-compose down
```

8. **Очистка ресурсов**:

    Если нужно очистить все контейнеры, тома и сети, используйте следующие команды:
```bash
    docker-compose down --volumes --remove-orphans
    docker system prune -a --volumes
```

---
## API Документация

Документация API доступна в формате Swagger и ReDoc:

- [Swagger UI](http://localhost:8000/swagger/)
- [ReDoc](http://localhost:8000/redoc/)

## Тестирование

Для запуска тестов выполните:

```bash
python manage.py test
